<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base href="https://sinotrade.github.io/">
    <title>Ordering</title>

    
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="/css/landing-page.css" rel="stylesheet">

    
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-129719388-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
    <style>
    .navbar {
    border-color: #e7e7e7;
}

.content-section-a,
footer,
.navbar {
  background-color: #f8f8f8;
  color: #333;
}

.navbar a:link,
.navbar-default .navbar-nav>li>a {
  color: #777;
}

.navbar a:hover,
.navbar-default .navbar-nav>li>a:hover {
  color: rgb(51, 51, 51);
}

.content-section-b {
  background-color: white;
  color: #333;
}

body {
  color: rgb(51, 51, 51);
}

.header-container h1,
.header-container h2,
.header-container h3,
.header-container h4 {
  color: rgb(51, 51, 51);
}

  </style>

</head>
<body>


<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="page-scroll navbar-brand" href="#intro">Shioaji</a>
        </div>
        
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="page-scroll" href=https://github.com/Sinotrade/Shioaji>Github</a>
                </li>
                <li>
                    <a class="page-scroll" href=https://sinotrade.github.io/docs>Docs</a>
                </li>
                <li>
                    <a class="page-scroll" href=https://gitter.im/Sinotrade/Shioaji>Communication</a>
                </li>
            </ul>
        </div>
        
    </div>
    
</nav>


<section id="services">
   <div class="content-section-a">

      <div class="container">

        <div class="row">
          <div>
            <hr class="section-heading-spacer">
            <div class="clearfix"></div>
            <h2 class="section-heading">Ordering</h2>
            

<h3 id="order">order</h3>

<p>開始下單的部分吧!首先我們會需要先製作出Order一筆order物件，然後丟進api的place_order函式中，這個函式會回傳一個Trade物件包涵這筆單的狀態。</p>

<h3 id="order物件">Order物件</h3>

<p>Order物件需要帶入的參數部分一樣可以用?直接看到文件</p>

<blockquote>
<p>input</p>

<pre><code>api.Order?
</code></pre>

<p>output</p>

<pre><code>Init signature: api.Order(product_id, product_type, opt_type, price, price_type, order_bs, order_type, octype, quantity, account)
Docstring: 
create order object
product_id: str 
    the product code
product_type: {'F', 'O'}
    - F: future
    - O: option
opt_type: {' ', 'C', 'P'}
    the option type Call or Put, leave blank if place future order
    - ' ': Future
    - 'C': Call
    - 'P': Put 
price: float or int
    order price
price_type: {LMT, MKT, MKP}
    - LMT: limit
    - MKT: market
    - MKP: market range
order_bs: {'B', 'S', 
    - 'B': buy
    - 'S': sell
order_type: {ROD, IOC, FOK}
    - ROD: Rest of Day
    - IOC: Immediate-or-Cancel
    - FOK: Fill-or-Kill
octype: {' ', '0', '1', '6'}, 
    - ' ': auto
    - '0': new position
    - '1': close position
    - '6': day trade
quantity: int
</code></pre>
</blockquote>

<p>接著我們有做一件方便大家開發的事，有兩個物件<code>api.Order_props</code>跟<code>api.Contracts</code>這兩個物件可以快速輔助開發的時候直接用tab自動補齊的方式找到Order物件中需要填入的欄位。</p>

<blockquote>
<p>input</p>

<pre><code>api.Order_props.&lt;/tab&gt;
api.Contracts.&lt;/tab&gt;
</code></pre>

<p>這邊我們以期貨為範例按tab鍵自動補齊可交易的合約</p>

<pre><code>api.Contracts.Future.TXF.TXF201903
</code></pre>

<p>output</p>

<pre><code>Contract
    Code: TXFC9
    Detail:
        code: TXFC9
        deliverymonth: 201903
        poc: 
        eprice: 0.0
        ename: TXF
        category: TXF
        prod_kind: I
        csname: 台指期貨
        ostock: #001
        basic: 0001.000000
</code></pre>
</blockquote>

<p>知道使用方式後我們直接用自動補齊的方式幫我快速創建一筆Order，下面這個例子我們可以看到product_id就是用Contracts來填入，其他的參數在Order_props都有相對應的欄位可以幫我們免去用文件的選項輸入，當然也可以直接使用文件的選項直接填入。</p>

<pre><code>sample_order = api.Order(product_id=api.Contracts.Future.TXF.TXF201903.code, 
                         product_type=api.Order_props.product_type.Future, 
                         opt_type=api.Order_props.opt_type.Future,
                         price=9600,
                         price_type=api.Order_props.price_type.LMT,
                         order_bs=api.Order_props.order_bs.Buy,
                         order_type=api.Order_props.order_type.ROD,
                         octype=api.Order_props.octype.auto,
                         quantity=5,
                         account=api.fut_account,
                        )
</code></pre>

<h3 id="下單函式">下單函式</h3>

<p>接著我們把order物件傳進<code>place_order</code>函式中就會送出委託單了。</p>

<blockquote>
<p>input</p>

<pre><code>trade = api.place_order(sample_order)
trade
</code></pre>

<p>output</p>

<pre><code>Trade
    status: order_sent
        status_code: 
        errmsg: 
        product_id: TXFC9
        ordno: 
        seqno: 702330
        ord_bs: B
        price: 9600
        quantity: 5
        price_type: LMT
        account: {'account': '9104000', 'username': '莊*芬', 'datacount': 0, 'accttype': 'F', 'broker_id': 'F002000', 'idno': 'SCCEIEFAJA'}
        msg:                                                             
        trade_type: 01
        octype:  
        mttype: 0
        composit: 00
        ord_date: 20181119
        preord_date: 20181119
        ord_time: 15:45:48
        ord_type: ROD
        product_type: F
        opt_type:  
</code></pre>
</blockquote>

<h3 id="trade物件">Trade物件</h3>

<p>拿到的Trade物件我們可以透過<code>update_status</code>函式來看目前order的狀態</p>

<blockquote>
<p>input</p>

<pre><code>trade.update_status(api.client)
trade
</code></pre>

<p>output</p>

<pre><code>Trade
    status: order_sent
        status_code: 0000
        errmsg: 
        product_id: TXFC9
        ordno: kY012
        seqno: 702330
        ord_bs: B
        price: 9600.0
        quantity: 5
        price_type: LMT
        account: {'account': '9104000', 'username': '莊*芬', 'datacount': 0, 'accttype': 'F', 'broker_id': 'F002000', 'idno': 'SCCEIEFAJA'}
        msg:                                                             
        trade_type: 01
        octype:  
        mttype: 0
        composit: 00
        ord_date: 20181119
        preord_date: 20181119
        ord_time: 15:45:48
        ord_type: ROD
        product_type: F
        opt_type:  
</code></pre>
</blockquote>

<p>改價或改量的部分使用<code>api.update_order</code>函式傳入Trade物件</p>

<blockquote>
<p>input</p>

<pre><code>trade = api.update_order(trade, price=9800, qty=1)
trade
</code></pre>

<p>output</p>

<pre><code>Trade
    status: order_sent
        status_code: 0000
        errmsg: 
        product_id: TXFC9
        ordno: kY012
        seqno: 702330
        ord_bs: B
        price: 9800.0
        quantity: 5
        price_type: LMT
        account: {'account': '9104000', 'username': '莊*芬', 'datacount': 0, 'accttype': 'F', 'broker_id': 'F002000', 'idno': 'SCCEIEFAJA'}
        msg:                                                             
        trade_type: 01
        octype:  
        mttype: 0
        composit: 00
        ord_date: 20181119
        preord_date: 20181119
        ord_time: 15:45:48
        ord_type: ROD
        product_type: F
        opt_type:  
</code></pre>
</blockquote>

<p>取消委託使用<code>api.cancel_order</code>函式並傳入欲取消的trade物件，就不寫出範例code了。</p>

        </div>
    </div>

</div>
</div>

</section>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <p class="copyright text-muted small">Copyright &copy; Sinotrade All Rights Reserved</p>
            </div>
        </div>
    </div>
</footer>

<script src="/js/jquery-1.11.0.js"></script>


<script src="/js/jquery.easing.min.js"></script>


<script src="/js/bootstrap.min.js"></script>


<script src="js/landing-page.js"></script>



</body>
</html>

