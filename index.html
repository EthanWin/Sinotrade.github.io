<!DOCTYPE html>
<html>
<head>
	<meta name="generator" content="Hugo 0.50" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <base href="https://sinotrade.github.io/">
    <title>Shioaji</title>

    
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="/css/landing-page.css" rel="stylesheet">

    
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
    
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-129719388-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
    <style>
    .navbar {
    border-color: #e7e7e7;
}

.content-section-a,
footer,
.navbar {
  background-color: #f8f8f8;
  color: #333;
}

.navbar a:link,
.navbar-default .navbar-nav>li>a {
  color: #777;
}

.navbar a:hover,
.navbar-default .navbar-nav>li>a:hover {
  color: rgb(51, 51, 51);
}

.content-section-b {
  background-color: white;
  color: #333;
}

body {
  color: rgb(51, 51, 51);
}

.header-container h1,
.header-container h2,
.header-container h3,
.header-container h4 {
  color: rgb(51, 51, 51);
}

  </style>

</head>
<body>


<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="page-scroll navbar-brand" href="#intro">Shioaji</a>
        </div>
        
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="page-scroll" href=https://github.com/Sinotrade/Shioaji>Github</a>
                </li>
                <li>
                    <a class="page-scroll" href=https://sinotrade.github.io/slides/shioaji_tutorial.slides.html?transition&#61;convex>Slides</a>
                </li>
                <li>
                    <a class="page-scroll" href=https://gitter.im/Sinotrade/Shioaji>Communication</a>
                </li>
            </ul>
        </div>
        
    </div>
    
</nav>

<section id="intro">
	
	<div class="intro-header">

		<div class="container header-container">

			<div class="row">
				<div class="intro-image col-md-4"></div>
				<div class="intro-message col-md-6">
					<h1>Shioaji</h1>
					<h3>Shioaji is sinopac provide the most pythonic api for trading the taiwan and global financial market. You can use your favorite Python packages such as numpy, scipy, pandas, pytorch or tensorflow to build your own trading model with intergrated the shioaji api on cross platform.</h3>

					
					
					

					<iframe class="github-btn" src="https://ghbtns.com/github-btn.html?user=Sinotrade&repo=Shioaji&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>
					

					<hr class="intro-divider">
				</div>
			</div>

		</div>
		

	</div>
	
</section>

<section id="services">


 
    
    <div class="content-section-a">
    

        <div class="container">

            <div class="row">
                <div>
                    <hr class="section-heading-spacer">
                    <div class="clearfix"></div>
                    <h2 class="section-heading">Contents</h2>
                    <ul>
<li><a href="#install">安裝</a>

<ul>
<li><a href="#pip-install">pip install</a></li>
<li><a href="#docker">docker</a></li>
</ul></li>
<li><a href="#init">初始化</a>

<ul>
<li><a href="#載入">載入</a></li>
<li><a href="#初始api">初始api</a></li>
<li><a href="#登入">登入</a></li>
<li><a href="#激活憑證">激活憑證</a></li>
</ul></li>
<li><a href="#order">下單</a>

<ul>
<li><a href="#Order物件">Order物件</a></li>
<li><a href="#下單函式">下單函式</a></li>
<li><a href="#Trade">Trade物件</a></li>
</ul></li>
<li><a href="#account">帳務</a>

<ul>
<li><a href="#權益數帳務">權益數帳務</a></li>
<li><a href="#未平倉帳務">未平倉帳務</a></li>
<li><a href="#平倉損益">平倉損益</a></li>
</ul></li>
</ul>

                </div>
            </div>

        </div>
        

    </div>

    
    <div class="content-section-b">
    

        <div class="container">

            <div class="row">
                <div>
                    <hr class="section-heading-spacer">
                    <div class="clearfix"></div>
                    <h2 class="section-heading">Installation</h2>
                    

<h3 id="install">install</h3>

<h2 id="let-s-get-it">Let&rsquo;s get it</h2>

<h3 id="pip-install">pip install</h3>

<p>直接pip install起來，台灣應該沒有其他券商的api那麼方便了。</p>

<pre><code>pip install shioaji
</code></pre>

<h3 id="docker">docker</h3>

<p>我們也準備好了docker image給各位直接使用，有需要那些其他的linux distribution歡迎在github上跟我們講。</p>

<pre><code>docker run -it sinotrade/shioaji:latest bash
</code></pre>

<p>這邊沒有在使用docker的可以忽略，docker主要就是幫各位處理好各種環境問題，但是基本上大家應該pip install就可以開了</p>

<p>這邊也幫大家build好jupyter的環境，執行下面docker指令連到<a href="http://localhost:8888">localhost:8888</a>就可以使用了</p>

<pre><code>docker run -p 8888:8888 sinotrade/shioaji:jupyter
</code></pre>

                </div>
            </div>

        </div>
        

    </div>

    
    <div class="content-section-a">
    

        <div class="container">

            <div class="row">
                <div>
                    <hr class="section-heading-spacer">
                    <div class="clearfix"></div>
                    <h2 class="section-heading">Initialization</h2>
                    

<h3 id="init">init</h3>

<p>pip install shioaji 了之後，接著我們就可以用 python, ipython, jupyter notebook 或 JupyterLab 等編輯器開始接下來旅程。</p>

<p>在這邊我們還需要一個條件，就是請先開好永豐金證券的帳戶，實體開戶或是直接<a href="https://www.sinotrade.com.tw/newweb/OpenAccount?source=shioaji">線上開戶</a>。</p>

<p>準備好永豐帳戶就讓我們開始吧!</p>

<h3 id="載入">載入</h3>

<p>起手式 import我們的api就像import tensorflow pandas等等一樣</p>

<pre><code>import shioaji as sj
</code></pre>

<h3 id="初始api">初始api</h3>

<p>接著我們需要初始化Shioaji這個物件來開始接下來要做的事</p>

<p>ipython有個很方便的方法可以看這個物件或函式的文件，就是直接在function或object後面加上<code>?</code></p>

<p>下面文件部分可以看到我們api底下所有可以用的function跟object以及初始化Shioaji的參數說明</p>

<p>input</p>

<pre><code>sj.Shioaji?
</code></pre>

<p>output</p>

<pre><code>Init signature: sj.Shioaji(backend='http', simulation=True, proxies={}, currency='NTD')
Docstring:    
shioaji api 

Functions:
    login 
    activate_ca
    list_accounts
    set_default_account
    get_account_margin 
    get_account_openposition
    get_account_settle_profitloss
    place_order
    update_order
    update_status
    list_trades

Objects:
    Contracts
    Order
Init docstring:
initialize Shioaji to start trading

Args:
    backend (str): {http, socket} 
        use http or socket as backend currently only support http, async socket backend coming soon.
    simulation (bool): 
        - False: to trading on real market (just use your Sinopac account to start trading)
        - True: become simulation account(need to contract as to open simulation account)
    proxies (dict): specific the proxies of your https
        ex: {'https': 'your-proxy-url'}
    currency (str): {NTX, USX, NTD, USD, HKD, EUR, JPY, GBP}
        set the default currency for display
</code></pre>

<p>這邊我們選擇http為backend，並且關閉模擬模式，如果有需要使用模擬的客戶麻煩在gitter中聯絡我們，http比較完整socket會在近日釋出敬請期待。</p>

<p>input</p>

<pre><code>api = sj.Shioaji(backend='http', simulation=False)
</code></pre>

<h3 id="登入">登入</h3>

<p>接著我們要登入才有辦法開始使用api，登入帳號就是永豐金證券電子平台（如：eLeader）的登入帳號密碼。</p>

<p>input</p>

<pre><code>api.login?
</code></pre>

<p>output</p>

<pre><code>Signature: api.login(person_id, passwd)
Docstring:
login to trading server

Args:
    person_id (str): Same as your eleader, ileader login id(usually your person ID)
    passwd  (str): the password of your eleader login password(not ca password)
</code></pre>

<p>登入後會預設抓出第一個期貨帳戶與證券戶作為預設帳戶</p>

<p>input</p>

<pre><code>api.login(person_id=person_id, passwd='2222')
api.fut_account
</code></pre>

<p>output</p>

<pre><code>FutureAccount(person_id='SCCEIEFAJA', broker_id='F002000', account_id='9104000', username='莊*芬')
</code></pre>

<p>也可以列出我們所有帳戶，並使用<code>api.set_default_account</code>將常用設為預設的帳戶</p>

<p>input</p>

<pre><code>api.list_accounts()
</code></pre>

<p>output</p>

<pre><code>[Account(account_type='H', person_id='QCCAHIFFDH', broker_id='1300', account_id='09800762', username='n*m'),
FutureAccount(person_id='SCCEIEFAJA', broker_id='F002000', account_id='9104000', username='莊*芬'),
StockAccount(person_id='SCCEIEFAJA', broker_id='9A92', account_id='9802195', username='莊*芬')]
</code></pre>

<h3 id="激活憑證">激活憑證</h3>

<p>以上動作已經完成與下單無關的動作的初始化了，需要下單的話必須啟動憑證，若只是帳務相關等功能無需憑證。</p>

<p>input</p>

<pre><code>api.activate_ca?
</code></pre>

<p>output</p>

<pre><code>Signature: api.activate_ca(ca_path, ca_passwd, person_id)
Docstring:
activate your ca for trading

Args: 
    ca_path (str):
        the path of your ca, support both absloutely and relatively path, use same ca with eleader
    ca_passwd (str): password of your ca
    person_id (str): the ca belong which person ID
</code></pre>

<p>input</p>

<pre><code>api.activate_ca(ca_path='../ca/Sinopac.pfx', ca_passwd='SCCEIEFAJA', person_id=person_id)
</code></pre>

<p>output</p>

<pre><code>Ca Initial Done.
0
</code></pre>

                </div>
            </div>

        </div>
        

    </div>

    
    <div class="content-section-b">
    

        <div class="container">

            <div class="row">
                <div>
                    <hr class="section-heading-spacer">
                    <div class="clearfix"></div>
                    <h2 class="section-heading">Ordering</h2>
                    

<h3 id="order">order</h3>

<p>開始下單的部分吧!首先api的place_order下單的函式中，需要傳入兩個物件，分別是Contract及Order，我們可以從Contracts物件中找到我們要交易的商品Contract，以及用Order製作出一筆order物件，然後丟進函式中，這個函式會回傳一個Trade物件包含Contract, Order及這筆單的狀態物件(OrderStatus)。</p>

<h3 id="order物件">Order物件</h3>

<p>Order物件需要帶入的參數部分一樣可以用?直接看到文件</p>

<blockquote>
<p>input</p>

<pre><code>api.Order?
</code></pre>

<p>output</p>

<pre><code>Init signature: api.Order(action, price_type, order_type, price, quantity, *args, **kwargs)
Docstring:     
The basic order object to place order

Attributes:
    product_id (str): the code of product that order to placing
    action (srt): {B, S}, order action to buy or sell
        - B: buy
        - S: sell
    price_type (str): {LMT, MKT, MKP}, pricing type of order
        - LMT: limit
        - MKT: market
        - MKP: market range
    order_type (str): {ROD, IOC, FOK}, the type of order
        - ROD: Rest of Day
        - IOC: Immediate-or-Cancel
        - FOK: Fill-or-Kill
    octype (str): {' ', '0', '1', '6'}, the type or order to open new position or close position 
        - ' ': auto
        - '0': new position
        - '1': close position
        - '6': day trade
    price (float or int): the price of order
    quantity (int): the quantity of order
    account (:obj:Account): which account to place this order
    ca (binary): the ca of this order

</code></pre>
</blockquote>

<p>接著我們有做一件方便大家開發的事，有兩個物件<code>api.OrderProps</code>跟<code>api.Contracts</code>這兩個物件可以快速輔助開發的時候直接用tab自動補齊的方式找到Order物件中需要填入的欄位。</p>

<blockquote>
<p>input</p>

<pre><code>api.OrderProps.&lt;/tab&gt;
api.Contracts.&lt;/tab&gt;
</code></pre>

<p>這邊我們以期貨為範例按tab鍵自動補齊可交易的合約，回傳的Future物件就是一個期貨的Contract物件，可以以<code>isinstance(api.Contracts.Futures.TXF.TXF201903, shioaji.contracts.Contract)</code>來確認他確實是個Contract物件
input</p>

<pre><code>api.Contracts.Futures.TXF
</code></pre>

<p>output</p>

<pre><code>TXF(TXF201903, TXF201906, TXF201809, TXF201810, TXF201811, TXF201812)
</code></pre>

<p>input</p>

<pre><code>api.Contracts.Futures.TXF.TXF201903
</code></pre>

<p>output</p>

<pre><code>Future(symbol='TXF201903', code='TXFC9', name='台指期貨', category='TXF', delivery_month='201903', underlying_kind='I', underlying_code='#001', unit=1.0)
</code></pre>
</blockquote>

<p>知道使用方式後我們直接用自動補齊的方式幫我快速創建一筆Order，參數在OrderProps都有相對應的欄位可以幫我們免去用文件的選項輸入，當然也可以直接使用文件的選項直接填入。</p>

<pre><code>sample_order = api.Order(price=9600,
                         action=api.OrderProps.action.Buy,
                         price_type=api.OrderProps.price_type.LMT,
                         order_type=api.OrderProps.order_type.ROD,
                         octype=api.OrderProps.octype.auto,
                         quantity=5,
                         account=api.fut_account,
                        )
</code></pre>

<p>另外為了不用煩鎖的Order我們可以直接使用MarketOrder, LimitOrder物件，需要填的選項就會很少。</p>

<h4 id="marketorder">MarketOrder</h4>

<pre><code>MarketOrder

    Args:
        product_id (str, optional): the code of product that order to placing 
                                    if not provide will gen from contract when placing order 
        action (srt): {B, S}, order action to buy or sell
            - B: buy
            - S: sell
        quantity (int): the quantity of order
        order_type (str, optional): {IOC, FOK}, the type of order
            - IOC: Immediate-or-Cancel
            - FOK: Fill-or-Kill
        octype (str, optional): {' ', '0', '1', '6'}, the type or order 
                                to open new position or close position 
                                if not provide will become auto mode 
            - ' ': auto
            - '0': new position
            - '1': close position
            - '6': day trade

</code></pre>

<p>製作一個MarketOrder物件就非常簡單，用下面填入買或賣，及口數就完成了。
&gt; input</p>

<pre><code>sample_mkt_order = api.MarketOrder('B', 5)
sample_mkt_order
</code></pre>

<p>output</p>

<pre><code>MarketOrder(action='B', order_type='IOC', quantity=5)
</code></pre>

<h4 id="limitorder">LimitOrder</h4>

<pre><code>LimitOrder

    Args:
        product_id (str, optional): the code of product that order to placing 
                                    if not provide will gen from contract when placing order 
        action (srt): {B, S}, order action to buy or sell
            - B: buy
            - S: sell
        price (float or int): the price of order
        quantity (int): the quantity of order
        order_type (str, optional): {ROD, IOC, FOK}, the type of order
            - ROD: Rest of Day
            - IOC: Immediate-or-Cancel
            - FOK: Fill-or-Kill
        octype (str, optional): {' ', '0', '1', '6'}, the type or order 
                                to open new position or close position 
                                if not provide will become auto mode 
            - ' ': auto
            - '0': new position
            - '1': close position
            - '6': day trade
</code></pre>

<p>限價單的部分就多一個參數，價格就完成了。</p>

<blockquote>
<p>input</p>

<pre><code>sample_limit_order = api.LimitOrder('B', 9700, 5)
sample_limit_order
</code></pre>

<p>output</p>

<pre><code>LimitOrder(action='B', order_type='ROD', price=9700, quantity=5)
</code></pre>
</blockquote>

<h3 id="下單函式">下單函式</h3>

<p>接著我們把製作好的Contract及Order物件傳進<code>place_order</code>函式中就會送出委託單了，這時候會回傳trade物件，Trade.status底下會是這筆交易的狀態，目前可以看到剛下出去是PendingSubmit。</p>

<blockquote>
<p>input</p>

<pre><code>txf = api.Contracts.Futures.TXF.TXF201903
trade = api.place_order(txf, sample_order)
</code></pre>

<p>output</p>

<pre><code>Trade(contract=Future(symbol='TXF201903', code='TXFC9', name='台指期貨', category='TXF', delivery_month='201903', underlying_kind='I', underlying_code='#001', unit=1.0), order=Order(product_id='TXFC9', action='B', price_type='LMT', order_type='ROD', price=9600, quantity=5, account=FutureAccount(person_id='SCCEIEFAJA', broker_id='F002000', account_id='9104000', username='莊*芬')), status=OrderStatus(seqno='701124', order_id='7521840eb43914f94f98f025b1762e0b250ded21', status='PendingSubmit', order_datetime=datetime.datetime(2019, 1, 16, 12, 39, 28)))
</code></pre>
</blockquote>

<h3 id="trade">Trade</h3>

<p>拿到的Trade物件我可以透過<code>update_status</code>函式來更新所有Trade的狀態，這時候就會看到狀態變為Submitted，成交後會變為Filled。</p>

<blockquote>
<p>input</p>

<pre><code>api.update_status()
trade
</code></pre>

<p>output</p>

<pre><code>Trade(contract=Future(symbol='TXF201903', code='TXFC9', name='台指期貨', category='TXF', delivery_month='201903', underlying_kind='I', underlying_code='#001', unit=1.0), order=Order(product_id='TXFC9', action='B', price_type='LMT', order_type='ROD', price=9600, quantity=5, account=FutureAccount(person_id='SCCEIEFAJA', broker_id='F002000', account_id='9104000', username='莊*芬')), status=OrderStatus(seqno='701124', ordno='ky00P', order_id='7521840eb43914f94f98f025b1762e0b250ded21', status='Submitted', status_code='0000', msg='ky00P', modified_price=9600.0, remaining=5, order_datetime=datetime.datetime(2019, 1, 16, 12, 39, 28)))
</code></pre>

<p>改價或改量的部分使用<code>api.update_order</code>函式傳入Trade物件，可以看到modified_price就變成9800並</p>

<p>input</p>

<pre><code>trade = api.update_order(trade, price=9800, qty=1)
trade
</code></pre>

<p>output</p>

<pre><code>Trade(contract=Future(symbol='TXF201903', code='TXFC9', name='台指期貨', category='TXF', delivery_month='201903', underlying_kind='I', underlying_code='#001', unit=1.0), order=Order(product_id='TXFC9', action='B', price_type='LMT', order_type='ROD', price=9600, quantity=5, account=FutureAccount(person_id='SCCEIEFAJA', broker_id='F002000', account_id='9104000', username='莊*芬')), status=OrderStatus(seqno='701124', ordno='ky00P', order_id='7521840eb43914f94f98f025b1762e0b250ded21', status='Submitted', status_code='0000', msg='ky00P', modified_price=9800.0, remaining=5, order_datetime=datetime.datetime(2019, 1, 16, 12, 39, 28)))
</code></pre>
</blockquote>

<p>取消委託使用<code>api.cancel_order</code>函式並傳入欲取消的trade物件，就不寫出範例code了。</p>

                </div>
            </div>

        </div>
        

    </div>

    
    <div class="content-section-a">
    

        <div class="container">

            <div class="row">
                <div>
                    <hr class="section-heading-spacer">
                    <div class="clearfix"></div>
                    <h2 class="section-heading">Account</h2>
                    

<h3 id="account">account</h3>

<p>下單ok後接著看帳務部分，帳務部份我們為了方便的與python的ecosystem結合，我們製作了將帳務的物件快速地轉換，就可以直接地變成pandas的Dataframe方便各位與自己的機器學習或深度學習模型直接介接。</p>

<h3 id="權益數帳務">權益數帳務</h3>

<p>input</p>

<pre><code>api.get_account_margin?
</code></pre>

<p>output</p>

<pre><code>Signature: api.get_account_margin(currency='NTD', margin_type='1', account={})
Docstring:
query margin    currency: {NTX, USX, NTD, USD, HKD, EUR, JPY, GBP}
the margin calculate in which currency
    - NTX: 約當台幣
    - USX: 約當美金
    - NTD: 新台幣
    - USD: 美元
    - HKD: 港幣
    - EUR: 歐元
    - JPY: 日幣
    - GBP: 英鎊
margin_type: {'1', '2'}
    query margin type
    - 1 : 即時
    - 2 : 風險
</code></pre>

<p>input</p>

<pre><code>account_margin = api.get_account_margin()
account_margin
</code></pre>

<p>output</p>

<pre><code>AccountMargin
    Currency: NTD
    Account: F0020009104000
    Detail:
        OrderPSecurity: 207000.0
        ProfitAccCount: 207000.0
        FProfit: 0.0
        FMissConProfit: 0.0
        OMissConProfit: 0.0
        OColse: 0.0
        OMarketPrice: 0.0
        OTodayDiff: 0.0
        HandCharge: 0.0
        TradeTax: 0.0
        Security: 0.0
        StartSecurity: 0.0
        UpKeepSecurity: 0.0
        Statistics: 99999.0
        Flow: 999.0
        orderBid: 0.0
        orderAsk: 0.0
        Conclusionbid: 0.0
        Conclusionask: 0.0
        YesterdayBalance: 207000.0
        PayMoney: 0.0
        Equity: 207000.0
        Ogain: 0.0
        exrate: 1.0
        xgdamt: 0.0
        agtamt: 0.0
        YesterdayEquity: 207000.0
        Munet: 0.0
        Cashamt: 207000.0
        Bapamt: 0.0
        Sapamt: 0.0
        Adps: 0.0
        Adamt: 0.0
        Ybaln: 207000.0
</code></pre>

<p>直接用將物件傳入<code>pandas.DataFrame</code>就可以簡單的拿到常用的dataframe了</p>

<p>input</p>

<pre><code>df_margin = pd.DataFrame([{**account_margin}])
df_margin
</code></pre>

<p>output
<div class="table-responsive">
<table class="table">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Adamt</th>
      <th>Adps</th>
      <th>Bapamt</th>
      <th>Cashamt</th>
      <th>Conclusionask</th>
      <th>Conclusionbid</th>
      <th>Equity</th>
      <th>FMissConProfit</th>
      <th>FProfit</th>
      <th>Flow</th>
      <th>&hellip;</th>
      <th>TradeTax</th>
      <th>UpKeepSecurity</th>
      <th>Ybaln</th>
      <th>YesterdayBalance</th>
      <th>YesterdayEquity</th>
      <th>agtamt</th>
      <th>exrate</th>
      <th>orderAsk</th>
      <th>orderBid</th>
      <th>xgdamt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>288000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>288000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>999.0</td>
      <td>&hellip;</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>207000.0</td>
      <td>207000.0</td>
      <td>207000.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 34 columns</p>
</div></p>

<h3 id="未平倉帳務">未平倉帳務</h3>

<p>input</p>

<pre><code>api.get_account_openposition?
</code></pre>

<p>output</p>

<pre><code>Signature: api.get_account_openposition(product_type='0', query_type='0', account={})
Docstring:
query open position
product_type: {0, 1, 2, 3}
    filter product type of open position
    - 0: all
    - 1: future
    - 2: option
    - 3: usd base
query_type: {0, 1}
    query return with detail or summary
    - 0: detail
    - 1: summary
</code></pre>

<p>input</p>

<pre><code>positions = api.get_account_openposition(query_type='1', account=api.fut_account)
positions
</code></pre>

<p>output</p>

<pre><code>AccountOpenPosition
</code></pre>

<p>轉換成dataframe</p>

<p>input</p>

<pre><code>df_positions = pd.DataFrame(positions.data())
df_positions
</code></pre>

<p>output
<div class="table-responsive">
<table class="table">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Account</th>
      <th>Code</th>
      <th>CodeName</th>
      <th>ContractAverPrice</th>
      <th>Currency</th>
      <th>Date</th>
      <th>FlowProfitLoss</th>
      <th>MTAMT</th>
      <th>OTAMT</th>
      <th>OrderBS</th>
      <th>OrderNum</th>
      <th>OrderType</th>
      <th>RealPrice</th>
      <th>SettlePrice</th>
      <th>SettleProfitLoss</th>
      <th>StartSecurity</th>
      <th>UpKeepSecurity</th>
      <th>Volume</th>
      <th>paddingByte</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FF0020009104000</td>
      <td>TXFA9</td>
      <td>台指期貨 01</td>
      <td>9508.4137</td>
      <td>NTD</td>
      <td>00000000</td>
      <td>4795201.620000</td>
      <td>6438000.000000</td>
      <td>8352000.000000</td>
      <td>B</td>
      <td></td>
      <td></td>
      <td>9784.0</td>
      <td>9784.00</td>
      <td>4795201.620000</td>
      <td>8352000.000000</td>
      <td>6438000.000000</td>
      <td>87.000000</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>FF0020009104000</td>
      <td>XJFF9</td>
      <td>日圓期貨 06</td>
      <td>80.0000</td>
      <td>JPY</td>
      <td>00000000</td>
      <td>31400.000000</td>
      <td>47000.000000</td>
      <td>61000.000000</td>
      <td>B</td>
      <td></td>
      <td></td>
      <td>0.0</td>
      <td>81.57</td>
      <td>31400.000000</td>
      <td>61000.000000</td>
      <td>47000.000000</td>
      <td>1.000000</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>FF0020009104000</td>
      <td>TXO08000L8</td>
      <td>台指選擇權 8000 C 12</td>
      <td>1870.0000</td>
      <td>NTD</td>
      <td>00000000</td>
      <td>-14000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>B</td>
      <td></td>
      <td></td>
      <td>1730.0</td>
      <td>1810.00</td>
      <td>-6000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td>FF0020009104000</td>
      <td>TXO09200L8</td>
      <td>台指選擇權 9200 C 12</td>
      <td>720.0000</td>
      <td>NTD</td>
      <td>00000000</td>
      <td>11250.000000</td>
      <td>147000.000000</td>
      <td>162000.000000</td>
      <td>S</td>
      <td></td>
      <td></td>
      <td>645.0</td>
      <td>660.00</td>
      <td>9000.000000</td>
      <td>162000.000000</td>
      <td>147000.000000</td>
      <td>3.000000</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td>FF0020009104000</td>
      <td>TXO09400X8</td>
      <td>台指選擇權 9400 P 12</td>
      <td>199.0000</td>
      <td>NTD</td>
      <td>00000000</td>
      <td>21200.000000</td>
      <td>57600.000000</td>
      <td>65600.000000</td>
      <td>S</td>
      <td></td>
      <td></td>
      <td>93.0</td>
      <td>93.00</td>
      <td>21200.000000</td>
      <td>65600.000000</td>
      <td>57600.000000</td>
      <td>4.000000</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>FF0020009104000</td>
      <td>TXO10200L8</td>
      <td>台指選擇權 10200 C 12</td>
      <td>111.0000</td>
      <td>NTD</td>
      <td>00000000</td>
      <td>33550.000000</td>
      <td>125950.000000</td>
      <td>147950.000000</td>
      <td>S</td>
      <td></td>
      <td></td>
      <td>50.0</td>
      <td>50.00</td>
      <td>33550.000000</td>
      <td>147950.000000</td>
      <td>125950.000000</td>
      <td>11.000000</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></p>

<h3 id="平倉損益">平倉損益</h3>

<p>input</p>

<pre><code>api.get_account_settle_profitloss?
</code></pre>

<p>output</p>

<pre><code>    Signature: api.get_account_settle_profitloss(product_type='0', summary='Y', start_date='', end_date='', currency='', account={})
    Docstring:
    query settlement profit loss
    product_type: {0, 1, 2}
        filter product type of open position
        - 0: all
        - 1: future
        - 2: option
    summary: {Y, N}
        query return with detail or summary
        - Y: summary
        - N: detail
    start_date: str
        the start date of query range format with %Y%m%d
        ex: 20180101
    end_date: str
        the end date of query range format with %Y%m%d
        ex: 20180201
    currency: {NTD, USD, HKD, EUR, CAD, BAS}
        the profit loss calculate in which currency
        - NTD: 新台幣
        - USD: 美元
        - HKD: 港幣
        - EUR: 歐元
        - CAD: 加幣 
        - BAS: 基幣
</code></pre>

<p>input</p>

<pre><code>st_date = (date.today() - timedelta(days=60)).strftime('%Y%m%d')
settle_profitloss = api.get_account_settle_profitloss(summary='Y', start_date=st_date)
settle_profitloss
</code></pre>

<p>output</p>

<pre><code>AccountSettleProfitLoss
</code></pre>

<p>轉換成dataframe</p>

<p>input</p>

<pre><code>df_profitloss = pd.DataFrame(settle_profitloss.data())
df_profitloss
</code></pre>

<p>output</p>

<div class="table-responsive">
<table class="table">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>account</th>
      <th>averagePrice</th>
      <th>code</th>
      <th>codeName</th>
      <th>currency</th>
      <th>floatProfitLoss</th>
      <th>handCharge</th>
      <th>ord_bs</th>
      <th>ord_type</th>
      <th>ordno</th>
      <th>ordno_b</th>
      <th>settleAvgPrc</th>
      <th>settleDate</th>
      <th>settleVolume</th>
      <th>tFlag</th>
      <th>tdate</th>
      <th>tradeProfitLoss</th>
      <th>tradeTax</th>
      <th>unVolume</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F0020009104000</td>
      <td>9900.0</td>
      <td>TXFK8</td>
      <td>台指期貨 11</td>
      <td>NTD</td>
      <td>460.000000</td>
      <td>60.000000</td>
      <td>S</td>
      <td>00</td>
      <td>kY002</td>
      <td>kY003</td>
      <td>9897.0</td>
      <td>20181022</td>
      <td>1.000000</td>
      <td>1</td>
      <td>20181022</td>
      <td>600.000000</td>
      <td>80.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>

                </div>
            </div>

        </div>
        

    </div>

    
    <div class="content-section-b">
    

        <div class="container">

            <div class="row">
                <div>
                    <hr class="section-heading-spacer">
                    <div class="clearfix"></div>
                    <h2 class="section-heading">DevelopEnvSetup</h2>
                    

<h3 id="開發環境設置windows">開發環境設置Windows</h3>

<p><a href="#開發環境設置Windows">Windows</a>開發環境安裝app清單</p>

<ul>
<li>git(version control)</li>
<li>vscode(text editor)</li>
<li>miniconda(python package management)</li>
<li>docker(optional)</li>
</ul>

<h4 id="git">Git</h4>

<p><a href="https://git-scm.com/download/win">下載window版本Git</a>
安裝時請選Use Git and optional Unix tools from the Windows Command Prompt</p>

<h4 id="vscode">VSCode</h4>

<p><a href="https://code.visualstudio.com/">下載Windows版本VSCode</a>
安裝後到插件管理中搜尋python並安裝</p>

<h4 id="miniconda">miniconda</h4>

<p><a href="https://repo.anaconda.com/miniconda/Miniconda3-latest-Windows-x86_64.exe">下載miniconda</a>
我們在windows中使用miniconda來安裝我們的環境，安裝完成後打開cmd，輸入 <code>conda install jupyterlab pandas -y</code> 把相關的套件裝好接著輸入<code>jupyter lab</code>，打開瀏覽器連到 <a href="http://localhost:8888">localhost:8888</a> 就可以連到jupyter開始使用。</p>

                </div>
            </div>

        </div>
        

    </div>


</section>


<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <p class="copyright text-muted small">Copyright &copy; Sinotrade All Rights Reserved</p>
            </div>
        </div>
    </div>
</footer>

<script src="/js/jquery-1.11.0.js"></script>


<script src="/js/jquery.easing.min.js"></script>


<script src="/js/bootstrap.min.js"></script>


<script src="js/landing-page.js"></script>



</body>
</html>

